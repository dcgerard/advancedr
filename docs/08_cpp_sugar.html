<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="David Gerard" />

<meta name="date" content="2022-02-21" />

<title>Rcpp Sugar</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<link rel="shortcut icon" href="https://dcgerard.github.io/advancedr/au_logo_small.png" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Teaching Website for Advanced R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="data.html">Data</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dcgerard/advancedr">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Rcpp Sugar</h1>
<h4 class="author">David Gerard</h4>
<h4 class="date">2022-02-21</h4>

</div>

<div id="TOC">
<ul>
<li><a href="#learning-objectives">Learning Objectives</a></li>
<li><a href="#motivation">Motivation</a></li>
<li><a href="#arithmetic-operations">Arithmetic Operations</a></li>
<li><a href="#logical-operations">Logical Operations</a></li>
<li><a href="#r-like-functions">R-like Functions</a>
<ul>
<li><a href="#vector-to-vector-math-functions">Vector to Vector Math Functions</a></li>
<li><a href="#summary-math-functions">Summary Math Functions</a></li>
<li><a href="#predicate-functions">Predicate Functions</a></li>
<li><a href="#utility-funtions">Utility Funtions</a></li>
<li><a href="#statistical-functions">Statistical Functions</a></li>
</ul></li>
<li><a href="#exercises">Exercises:</a></li>
</ul>
</div>

<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('left', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<div id="learning-objectives" class="section level1">
<h1>Learning Objectives</h1>
<ul>
<li>Chapters 11, 21–22 of <a href="https://teuder.github.io/rcpp4everyone_en/">Rcpp for Everyone</a></li>
<li>Chapter 25 of <a href="https://adv-r.hadley.nz/rcpp.html">Advanced R</a></li>
<li><a href="https://dirk.eddelbuettel.com/code/rcpp/Rcpp-quickref.pdf">Rcpp Quick Reference Guide</a></li>
<li><a href="https://dirk.eddelbuettel.com/code/rcpp/Rcpp-sugar.pdf">Rcpp syntactic sugar</a></li>
<li>Learning Objectives:
<ul>
<li>R-like functions implemented by Rcpp</li>
</ul></li>
</ul>
</div>
<div id="motivation" class="section level1">
<h1>Motivation</h1>
<ul>
<li><p>C++ is pretty esoteric — you have to keep track of a lot of boilerplate to implement anything.</p></li>
<li><p>Rcpp Sugar is a set of functions that comes with Rcpp to allow you to code in C++ in ways that looks like R code.</p></li>
<li><p>This is not how C++ programmers do things, but it makes it easy for you (an expert R programmer) to code in C++ when you want just something to help your R code.</p></li>
</ul>
</div>
<div id="arithmetic-operations" class="section level1">
<h1>Arithmetic Operations</h1>
<ul>
<li><p>With Rcpp Sugar, you can do vectorized arithmetic operations as you would in R, as long as you are using Rcpp vectors (examples below from <a href="https://dirk.eddelbuettel.com/code/rcpp/Rcpp-sugar.pdf">Rcpp-sugar</a>).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">// two numeric vectors of the same size</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>NumericVector x<span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>NumericVector y<span class="op">;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">// expressions involving two vectors</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>NumericVector res <span class="op">=</span> x <span class="op">+</span> y<span class="op">;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>NumericVector res <span class="op">=</span> x <span class="op">-</span> y<span class="op">;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>NumericVector res <span class="op">=</span> x <span class="op">*</span> y<span class="op">;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>NumericVector res <span class="op">=</span> x <span class="op">/</span> y<span class="op">;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">// one vector, one single value</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>NumericVector res <span class="op">=</span> x <span class="op">+</span> <span class="fl">2.0</span><span class="op">;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>NumericVector res <span class="op">=</span> <span class="fl">2.0</span> <span class="op">-</span> x<span class="op">;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>NumericVector res <span class="op">=</span> y <span class="op">*</span> <span class="fl">2.0</span><span class="op">;</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>NumericVector res <span class="op">=</span> <span class="fl">2.0</span> <span class="op">/</span> y<span class="op">;</span></span></code></pre></div></li>
</ul>
</div>
<div id="logical-operations" class="section level1">
<h1>Logical Operations</h1>
<ul>
<li><p>You can create <code>LogicalVector</code>s as you would in R using logical operators.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">// two integer vectors of the same size</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>NumericVector x<span class="op">;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>NumericVector y<span class="op">;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">// expressions involving two vectors</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>LogicalVector res <span class="op">=</span> x <span class="op">&lt;</span> y<span class="op">;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>LogicalVector res <span class="op">=</span> x <span class="op">&gt;</span> y<span class="op">;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>LogicalVector res <span class="op">=</span> x <span class="op">&lt;=</span> y<span class="op">;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>LogicalVector res <span class="op">=</span> x <span class="op">&gt;=</span> y<span class="op">;</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>LogicalVector res <span class="op">=</span> x <span class="op">==</span> y<span class="op">;</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>LogicalVector res <span class="op">=</span> x <span class="op">!=</span> y<span class="op">;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">// one vector, one single value</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>LogicalVector res <span class="op">=</span> x <span class="op">&lt;</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>LogicalVector res <span class="op">=</span> <span class="dv">2</span> <span class="op">&gt;</span> x<span class="op">;</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>LogicalVector res <span class="op">=</span> y <span class="op">&lt;=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>LogicalVector res <span class="op">=</span> <span class="dv">2</span> <span class="op">!=</span> y<span class="op">;</span></span></code></pre></div></li>
</ul>
</div>
<div id="r-like-functions" class="section level1">
<h1>R-like Functions</h1>
<ul>
<li>There are tons of R-like functions that work on these vectors. These are the ones I use most often:</li>
</ul>
<div id="vector-to-vector-math-functions" class="section level2">
<h2>Vector to Vector Math Functions</h2>
<p>All of these take a numeric vector in, and return a numeric vector.</p>
<ul>
<li><code>abs()</code>: Absolute value</li>
<li><code>ceil()</code>: Round up.</li>
<li><code>cummax()</code>: Cumulative maximum.</li>
<li><code>cummin()</code>: Cumulative minimum.</li>
<li><code>cumprod()</code>: Cumulative product.</li>
<li><code>cumsum()</code>: Cumulative summation.</li>
<li><code>exp()</code>: Exponentiation <span class="math inline">\(e^x\)</span>.</li>
<li><code>expm1()</code>: Exponentiation minus 1 (numerically stable for <code>x</code> close to 0). <span class="math inline">\(e^x - 1\)</span>.</li>
<li><code>factorial()</code>: <span class="math inline">\(x!\)</span></li>
<li><code>floor()</code>: Round down.</li>
<li><code>gamma()</code>: <a href="https://en.wikipedia.org/wiki/Gamma_function">Gamma function</a>.</li>
<li><code>lbeta()</code>: Log of the <a href="https://en.wikipedia.org/wiki/Beta_function">beta function</a>.</li>
<li><code>lchoose()</code>: Log of <a href="https://en.wikipedia.org/wiki/Combination">combination</a>.</li>
<li><code>lfactorial()</code>: Log of <a href="https://en.wikipedia.org/wiki/Factorial">factorial</a>.</li>
<li><code>lgamma()</code>: Log of <a href="https://en.wikipedia.org/wiki/Gamma_function">gamma function</a></li>
<li><code>log()</code>: Natural logarithm.</li>
<li><code>log10()</code>: Base 10 logarithm.</li>
<li><code>log1p()</code>: Log of one plus (numerically stable for <code>x</code> close to 0). <span class="math inline">\(\log(1 + x)\)</span>.</li>
<li><code>pmin()</code>: Point-wise minimum of two-vectors.</li>
<li><code>pmax()</code>: Point-wise maximum of two-vectors.</li>
<li><code>pow()</code>: Powers.</li>
<li><code>round()</code>: Round to nearest integer.</li>
<li><code>sqrt()</code>: Square root</li>
</ul>
</div>
<div id="summary-math-functions" class="section level2">
<h2>Summary Math Functions</h2>
<p>All of these take a numeric vector in, and return a scalar.</p>
<ul>
<li><code>max()</code>: Maximum.</li>
<li><code>mean()</code>: Sample arithmetic mean.</li>
<li><code>median()</code>: Median.</li>
<li><code>min()</code>: Minimum.</li>
<li><code>range()</code>: Returns a <code>NumericVector</code> of length 2 that contains the minimum and the maximum.</li>
<li><code>sd()</code>: Standard deviation.</li>
<li><code>sum()</code>: Summation.</li>
<li><code>var()</code>: Variance.</li>
</ul>
</div>
<div id="predicate-functions" class="section level2">
<h2>Predicate Functions</h2>
<ul>
<li><p><code>all()</code>: returns <code>TRUE</code> if all object elements are <code>TRUE</code>.</p></li>
<li><p><code>any()</code>: Returns <code>TRUE</code> if any of the elements are <code>TRUE</code>.</p></li>
<li><p><code>ifelse()</code>: Vectorized <code>if-else</code> statements.</p></li>
<li><p><code>is_finite()</code>: Returns <code>TRUE</code> if not infinite.</p></li>
<li><p><code>is_infinite()</code>: Returns <code>TRUE</code> if infinite.</p></li>
<li><p><code>is_na()</code>: Returns <code>TRUE</code> if missing.</p></li>
<li><p><code>is_nan()</code>: Returns <code>TRUE</code> if <code>nan</code>.</p></li>
<li><p>All of these return <code>LogicalVector</code>s, which are built on <code>int</code> not <code>bool</code> (because in R there is <code>NA</code>, but there is no <code>NA</code> equivalent in <code>bool</code>).</p></li>
<li><p>One consequence is that <code>all()</code> and <code>any()</code> do not return a <code>bool</code> object, so you cannot use them directly in <code>if-else</code> statements.</p></li>
<li><p>Instead, wrap <code>all()</code> and <code>any()</code> inside <code>is_true()</code> or <code>is_false()</code> to convert it to a <code>bool</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>is_true<span class="op">(</span>all<span class="op">(</span>v<span class="op">)))</span> <span class="op">{</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
<li><p>Another consequence is that you should not use individual elements of <code>LogicalVector</code>’s in <code>if-then</code> statements because <code>NA</code>’s will evaluate to the bool type <code>true</code>.</p></li>
<li><p>Instead, check if an element is <code>TRUE</code> (which is an object defined by Rcpp different from <code>true</code>).</p></li>
<li><p>E.g. if <code>v</code> is a <code>LogicalVector</code> then do:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>v<span class="op">[</span>i<span class="op">]==</span>TRUE<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>v<span class="op">[</span>i<span class="op">]==</span>FALSE<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>v<span class="op">[</span>i<span class="op">]==</span>NA_LOGICAL<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
<li><p><strong>Example</strong>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>Rcpp<span class="op">::</span>NumericVector x <span class="op">=</span> <span class="op">{</span><span class="fl">1.0</span><span class="op">,</span> <span class="fl">2.0</span><span class="op">,</span> <span class="fl">3.0</span><span class="op">};</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>Rcpp<span class="op">::</span>LogicalVector z <span class="op">=</span> x <span class="op">&gt;</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>z<span class="op">(</span><span class="dv">2</span><span class="op">)</span> <span class="op">==</span> TRUE<span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  Rcpp<span class="op">::</span>Rcout <span class="op">&lt;&lt;</span> <span class="st">&quot;Hello&quot;</span> <span class="op">&lt;&lt;</span> <span class="bu">std::</span>endl<span class="op">;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
</ul>
</div>
<div id="utility-funtions" class="section level2">
<h2>Utility Funtions</h2>
<ul>
<li><code>diff(x)</code>: Lagged differences.</li>
<li><code>match(v, table)</code>: Same as R’s <code>match()</code> function. Note that the indexing starts at 1 (R style), not 0, in what is returned.</li>
<li><code>rep(x, n)</code>: Repeat a vector <code>n</code> times.</li>
<li><code>rev(x)</code>: Return a vector whose elements are in reverse order.</li>
<li><code>sample(Vector x, int size, replace = false, probs = R_NilValue)</code>: Sample from a vector. Same as the R function <code>sample()</code>.</li>
<li><code>seq(start, end)</code>: Returns a vector of consecutive integers from start to end.</li>
<li><code>seq_along(x)</code>: Returns a vector of consecutive integers from <code>1</code> to the length of a vector (does not start at 0).</li>
<li><code>seq_len(n)</code>: Returns a vector of consecutive integers from <code>1</code> to <code>n</code> (does not start at 0).</li>
<li><code>setdiff(v1, v2)</code>: Returns a vector of differences.</li>
<li><code>setequal(v1, v2)</code>: Returns <code>true</code> if unique elements in <code>v1</code> equal unique elements in <code>v2</code>.</li>
<li><code>unique(v)</code>: Returns a vector of unique values of v.</li>
<li><code>which_max(v)</code>: Returns the numerical index of the largest element. This is C-style indices, so starts at 0.</li>
<li><code>which_min(v)</code>: Returns the numerical index of the smallest element. This is C-style indices, so starts at 0.</li>
</ul>
</div>
<div id="statistical-functions" class="section level2">
<h2>Statistical Functions</h2>
<ul>
<li><p><code>d</code>/<code>q</code>/<code>p</code>/<code>r</code> (density/quantile/probability/random generation) functions exist for a variety of distributions. These allow for inputting and outputting <code>NumericVector</code>s (whereas the <code>Rmath</code> library only allows for scalar inputs and outputs).</p></li>
<li><p>See <a href="https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Distribution-functions">Distribution functions</a> for details on parameterizations.</p></li>
<li><p><code>dbeta()</code>, <code>qbeta()</code>, <code>pbeta()</code>, <code>rbeta()</code>: <a href="https://en.wikipedia.org/wiki/Beta_distribution">Beta distribution</a>.</p></li>
<li><p><code>dbinom()</code>, <code>qbinom()</code>, <code>pbinom()</code>, <code>rbinom()</code>: <a href="https://en.wikipedia.org/wiki/Binomial_distribution">Binomial distribution</a>.</p></li>
<li><p><code>dchisq()</code>, <code>qchisq()</code>, <code>pchisq()</code>, <code>rchisq()</code>: <a href="https://en.wikipedia.org/wiki/Chi-squared_distribution">Chi-squared distribution</a>.</p></li>
<li><p><code>dexp()</code>, <code>qexp()</code>, <code>pexp()</code>, <code>rexp()</code>: <a href="https://en.wikipedia.org/wiki/Exponential_distribution">Exponential distribution</a> using scale (and <strong>not</strong> rate) parameterization.</p></li>
<li><p><code>df()</code>, <code>qf()</code>, <code>pf()</code>, <code>rf()</code>: <a href="https://en.wikipedia.org/wiki/F-distribution"><span class="math inline">\(F\)</span>-distribution</a>.</p></li>
<li><p><code>dgamma()</code>, <code>qgamma()</code>, <code>pgamma()</code>, <code>rgamma()</code>: <a href="https://en.wikipedia.org/wiki/Gamma_distribution">Gamma distribution</a> using the shape and scale parameterization.</p></li>
<li><p><code>dgeom()</code>, <code>qgeom()</code>, <code>pgeom()</code>, <code>rgeom()</code>: <a href="https://en.wikipedia.org/wiki/Geometric_distribution">Geometric distribution</a>.</p></li>
<li><p><code>dhyper()</code>, <code>qhyper()</code>, <code>phyper()</code>, <code>rhyper()</code>: <a href="https://en.wikipedia.org/wiki/Hypergeometric_distribution">Hypergeometric distribution</a>.</p></li>
<li><p><code>dnbinom()</code>, <code>qnbinom()</code>, <code>pnbinom()</code>, <code>rnbinom()</code>: <a href="https://en.wikipedia.org/wiki/Negative_binomial_distribution">Negative Binomial distribution</a>.</p></li>
<li><p><code>dnorm4()</code>, <code>qnorm5()</code>, <code>pnorm5()</code>, <code>rnorm()</code>: <a href="https://en.wikipedia.org/wiki/Normal_distribution">Normal distribution</a>.</p></li>
<li><p><code>dpois()</code>, <code>qpois()</code>, <code>ppois()</code>, <code>rpois()</code>: <a href="https://en.wikipedia.org/wiki/Poisson_distribution">Poisson distribution</a>.</p></li>
<li><p><code>dt()</code>, <code>qt()</code>, <code>pt()</code>, <code>rt()</code>: <a href="https://en.wikipedia.org/wiki/Student%27s_t-distribution"><span class="math inline">\(t\)</span>-distribution</a>.</p></li>
<li><p><code>dunif()</code>, <code>qunif()</code>, <code>punif()</code>, <code>runif()</code>: <a href="https://en.wikipedia.org/wiki/Continuous_uniform_distribution">Uniform distribution</a>.</p></li>
</ul>
</div>
</div>
<div id="exercises" class="section level1">
<h1>Exercises:</h1>
<ol style="list-style-type: decimal">
<li><p>Use Rcpp Sugar to create a function called <code>msamp()</code> where the user inputs a sample size <code>n</code> and the output is the mean of a random sample of size <code>n</code> from a standard uniform distribution (over <span class="math inline">\([0,1]\)</span>). E.g.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">msamp</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.2655</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">msamp</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] 0.5456</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">msamp</span>(<span class="dv">100</span>)</span></code></pre></div>
<pre><code>## [1] 0.5229</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">msamp</span>(<span class="dv">1000</span>)</span></code></pre></div>
<pre><code>## [1] 0.4957</code></pre></li>
<li><p>The <a href="https://en.wikipedia.org/wiki/Multinomial_distribution">multinomial distribution</a> has PMF <span class="math display">\[
 \frac{n!}{x_1!x_2!\cdots x_k!}p_1^{x_1}p_2^{x_2}\ldots p_k^{x_k}
 \]</span> Here, <span class="math inline">\(x_i\)</span> is the number of counts in category <span class="math inline">\(i\)</span> and <span class="math inline">\(n\)</span> is the total number of counts, so <span class="math inline">\(n = x_1 + x_2 + \cdots + x_n\)</span>. Also, <span class="math inline">\(p_i\)</span> is the probability of category <span class="math inline">\(i\)</span>. Use Rcpp Sugar to create a function called <code>dmultinom_cpp()</code> that will take as input a <code>NumericVector</code> <code>x</code>, a <code>NumericVector</code> <code>p</code>, and a <code>bool</code> <code>lg</code> and return the log-PMF if <code>lg = true</code> and return the PMF if <code>lg = false</code>. For numerical stability, you should calculate the log values at each step and only exponentiate at the end (this is very typical in numerical computing). You can assume that all values of <span class="math inline">\(p_i\)</span> are non-zero.</p>
<p><em>Hint</em>: We have the relationship that <span class="math inline">\(\Gamma(n + 1) = n!\)</span>. This is needed for doing log-factorial on scalars.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dmultinom</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">2</span>), <span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">0.2</span>), <span class="at">log =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] -2.294</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dmultinom_cpp</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">2</span>), <span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">0.2</span>), <span class="at">lg =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] -2.294</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dmultinom</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">2</span>), <span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">0.2</span>), <span class="at">log =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.1008</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dmultinom_cpp</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">2</span>), <span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">0.2</span>), <span class="at">lg =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.1008</code></pre></li>
<li><p>Write a function called <code>scale01()</code> that takes as input a <code>NumericVector</code>, subtracts the minimum value, and divides by the maximum value of the resulting vector. So it scales all observations to be between 0 and 1. Use Rcpp Sugar.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">6</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">scale01</span>(x)</span></code></pre></div>
<pre><code>## [1] 0.00 0.25 0.50 0.75 1.00</code></pre></li>
</ol>
</div>

<!DOCTYPE html>
<hr>
<a href="https://nsf.gov/awardsearch/showAward?AWD_ID=2132247"><img src="https://dcgerard.github.io/advancedr/nsf_logo.png" alt="National Science Foundation Logo" height="48px"/></a>
<a href="https://www.american.edu/cas/mathstat/"><img src="https://dcgerard.github.io/advancedr/au_logo.png" alt="American University Logo" height="48px"/></a>
<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
